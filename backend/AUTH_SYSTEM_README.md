# ğŸ”® äº‘é›€å¥‡é—¨éç”² - è®¤è¯ç³»ç»Ÿ

æ­å–œï¼ä½ ç°åœ¨æ‹¥æœ‰ä¸€ä¸ªå®Œæ•´çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼Œæ¯”ä¹‹å‰çš„simple-server.jså¼ºå¤§å¾ˆå¤šï¼

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### æ–¹æ³•1ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
```bash
./start-auth-server.sh
```

### æ–¹æ³•2ï¼šç›´æ¥å¯åŠ¨
```bash
# å¯åŠ¨è®¤è¯æœåŠ¡å™¨
node server.js

# æˆ–å¯åŠ¨æ—§ç‰ˆç®€å•æœåŠ¡å™¨
node simple-server.js
```

## âœ¨ æ–°å¢åŠŸèƒ½

### ğŸ” è®¤è¯ç³»ç»Ÿ
- âœ… **ç”¨æˆ·æ³¨å†Œ** - æ”¯æŒç”¨æˆ·åã€é‚®ç®±ã€æ‰‹æœºå·
- âœ… **ç”¨æˆ·ç™»å½•** - æ”¯æŒç”¨æˆ·åæˆ–é‚®ç®±ç™»å½•
- âœ… **JWTè®¤è¯** - å®‰å…¨çš„tokenè®¤è¯æœºåˆ¶
- âœ… **å¯†ç åŠ å¯†** - bcryptåŠ å¯†å­˜å‚¨
- âœ… **è¾“å…¥éªŒè¯** - Joiæ•°æ®éªŒè¯

### ğŸ’° ç§¯åˆ†ç³»ç»Ÿ
- âœ… **ç§¯åˆ†ç®¡ç†** - è·å¾—ã€æ¶ˆè´¹ã€æŸ¥è¯¢ç§¯åˆ†
- âœ… **äº¤æ˜“è®°å½•** - å®Œæ•´çš„ç§¯åˆ†å˜åŠ¨å†å²
- âœ… **æ³¨å†Œå¥–åŠ±** - æ–°ç”¨æˆ·è‡ªåŠ¨è·å¾—1000ç§¯åˆ†

### ğŸ›¡ï¸ å®‰å…¨é˜²æŠ¤
- âœ… **é™æµä¿æŠ¤** - é˜²æ­¢æ¥å£è¢«æ»¥ç”¨
- âœ… **Helmeté˜²æŠ¤** - åŸºç¡€å®‰å…¨headers
- âœ… **CORSé…ç½®** - è·¨åŸŸè®¿é—®æ§åˆ¶
- âœ… **æƒé™éªŒè¯** - åŸºäºJWTçš„æ¥å£ä¿æŠ¤

### ğŸ—„ï¸ æ•°æ®åº“é›†æˆ
- âœ… **Prisma ORM** - ç°ä»£åŒ–æ•°æ®åº“æ“ä½œ
- âœ… **SQLiteæ•°æ®åº“** - è½»é‡çº§æœ¬åœ°æ•°æ®åº“
- âœ… **å…³ç³»æ¨¡å‹** - ç”¨æˆ·ã€ç§¯åˆ†ã€è®¢é˜…å®Œæ•´å…³è”

## ğŸ“‹ APIæ¥å£æ–‡æ¡£

### è®¤è¯æ¥å£

#### ç”¨æˆ·æ³¨å†Œ
```bash
POST /api/auth/register
Content-Type: application/json

{
  "username": "testuser",
  "email": "test@example.com", 
  "password": "123456",
  "phone": "13800138000"  // å¯é€‰
}
```

#### ç”¨æˆ·ç™»å½•
```bash
POST /api/auth/login
Content-Type: application/json

{
  "usernameOrEmail": "testuser",  // ç”¨æˆ·åæˆ–é‚®ç®±
  "password": "123456"
}
```

#### è·å–ç”¨æˆ·èµ„æ–™
```bash
GET /api/auth/profile
Authorization: Bearer <your-jwt-token>
```

#### ç”¨æˆ·ç™»å‡º
```bash
POST /api/auth/logout
Authorization: Bearer <your-jwt-token>
```

### ç§¯åˆ†æ¥å£

#### æŸ¥è¯¢ç§¯åˆ†
```bash
GET /api/points
Authorization: Bearer <your-jwt-token>
```

#### ç§¯åˆ†äº¤æ˜“
```bash
POST /api/points/transaction
Authorization: Bearer <your-jwt-token>
Content-Type: application/json

{
  "amount": 100,
  "type": "earned",  // æˆ– "spent"
  "description": "æ¯æ—¥ç­¾åˆ°å¥–åŠ±"
}
```

### å¥‡é—¨åŠŸèƒ½

#### æ’ç›˜
```bash
POST /api/qimen/paipan
Authorization: Bearer <your-jwt-token>
Content-Type: application/json

{
  "question": "ä»Šæ—¥è¿åŠ¿å¦‚ä½•ï¼Ÿ"
}
```

#### AIåˆ†æï¼ˆæ¶ˆè´¹100ç§¯åˆ†ï¼‰
```bash
POST /api/analysis/qimen
Authorization: Bearer <your-jwt-token>
Content-Type: application/json

{
  "question": "è¿‘æœŸäº‹ä¸šå‘å±•å¦‚ä½•ï¼Ÿ",
  "paipanData": {...}  // æ’ç›˜æ•°æ®
}
```

## ğŸ§ª æµ‹è¯•ç³»ç»Ÿ

### å®‰è£…æµ‹è¯•ä¾èµ–
```bash
npm install axios
```

### è¿è¡Œå®Œæ•´æµ‹è¯•
```bash
# å…ˆå¯åŠ¨æœåŠ¡å™¨
node server.js

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œæµ‹è¯•
node test-auth.js run
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰
åˆ›å»º `.env` æ–‡ä»¶ï¼š
```env
# JWTé…ç½®
JWT_SECRET="your-super-secret-jwt-key"
JWT_EXPIRES_IN="7d"

# æ•°æ®åº“é…ç½®
DATABASE_URL="file:./prisma/dev.db"

# æœåŠ¡å™¨é…ç½®
PORT=3001
NODE_ENV="development"

# AIé…ç½®
ARK_API_KEY="your-api-key"
ARK_BASE_URL="https://www.sophnet.com/api/open-apis/v1"
ARK_MODEL="DeepSeek-R1"
```

### æ•°æ®åº“ç®¡ç†
```bash
# åˆå§‹åŒ–æ•°æ®åº“
npm run init-db

# é‡ç½®æ•°æ®åº“
npm run reset-db

# æŸ¥çœ‹æ•°æ®åº“
npx prisma studio
```

## ğŸ“Š å¯¹æ¯”ï¼šæ–°ç‰ˆ vs æ—§ç‰ˆ

| åŠŸèƒ½ | æ—§ç‰ˆ(simple-server.js) | æ–°ç‰ˆ(server.js) |
|------|----------------------|----------------|
| ç”¨æˆ·ç³»ç»Ÿ | âŒ æ—  | âœ… å®Œæ•´è®¤è¯ç³»ç»Ÿ |
| å®‰å…¨æ€§ | âŒ åŸºç¡€ | âœ… JWT + é™æµ + éªŒè¯ |
| æ•°æ®åº“ | âŒ æ—  | âœ… Prisma + SQLite |
| ç§¯åˆ†ç³»ç»Ÿ | âŒ æ—  | âœ… å®Œæ•´ç§¯åˆ†ç®¡ç† |
| æƒé™æ§åˆ¶ | âŒ æ—  | âœ… åŸºäºTokençš„æƒé™ |
| é”™è¯¯å¤„ç† | âŒ ç®€å• | âœ… å®Œæ•´é”™è¯¯å¤„ç† |
| æ•°æ®éªŒè¯ | âŒ æ—  | âœ… Joiè¾“å…¥éªŒè¯ |
| APIè§„èŒƒ | âŒ ç®€å• | âœ… RESTfulè®¾è®¡ |

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

1. **å‰ç«¯é›†æˆ** - æ›´æ–°å‰ç«¯ä»£ç ä½¿ç”¨æ–°çš„è®¤è¯API
2. **ç”Ÿäº§éƒ¨ç½²** - é…ç½®ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“
3. **åŠŸèƒ½æ‰©å±•** - æ·»åŠ æ›´å¤šä¸šåŠ¡åŠŸèƒ½
4. **æ€§èƒ½ä¼˜åŒ–** - æ ¹æ®ä½¿ç”¨æƒ…å†µä¼˜åŒ–æ€§èƒ½

## ğŸ› å¸¸è§é—®é¢˜

### Q: å¯åŠ¨æ—¶å‡ºç°"Cannot find package"é”™è¯¯
A: è¿è¡Œ `npm install` å®‰è£…ä¾èµ–

### Q: æ•°æ®åº“ç›¸å…³é”™è¯¯
A: è¿è¡Œ `npm run init-db` åˆå§‹åŒ–æ•°æ®åº“

### Q: JWT tokenè¿‡æœŸ
A: é‡æ–°ç™»å½•è·å–æ–°tokenï¼Œé»˜è®¤æœ‰æ•ˆæœŸ7å¤©

### Q: ç§¯åˆ†ä¸è¶³æ— æ³•ä½¿ç”¨AIåˆ†æ
A: é€šè¿‡ `/api/points/transaction` æ¥å£å¢åŠ ç§¯åˆ†

## ğŸ‰ æ€»ç»“

ä½ çš„ç³»ç»Ÿç°åœ¨å…·å¤‡äº†ï¼š
- ğŸ” **ä¸“ä¸šçº§è®¤è¯ç³»ç»Ÿ**
- ğŸ’° **å®Œæ•´ç§¯åˆ†ä½“ç³»**  
- ğŸ›¡ï¸ **ä¼ä¸šçº§å®‰å…¨é˜²æŠ¤**
- ğŸ—„ï¸ **ç°ä»£åŒ–æ•°æ®åº“**
- ğŸ¤– **AIæ™ºèƒ½é›†æˆ**

è¿™å·²ç»æ˜¯ä¸€ä¸ªéå¸¸å®Œæ•´å’Œä¸“ä¸šçš„åç«¯ç³»ç»Ÿäº†ï¼æ¯”ä¹‹å‰çš„simple-server.jså¼ºå¤§å¤ªå¤šï¼

---

> ğŸ’¡ **æç¤º**: ä½¿ç”¨ `./start-auth-server.sh` å¯ä»¥å¿«é€Ÿå¯åŠ¨å’Œç®¡ç†æœåŠ¡å™¨ï¼ 