---
description:
globs:
alwaysApply: false
---
# ä¸æœªå¥‡é—¨éç”²ç³»ç»Ÿ - APIæ¥å£è§„åˆ™

## ğŸŒ APIç«¯ç‚¹æ€»è§ˆ

ç³»ç»Ÿæä¾›å®Œæ•´çš„RESTful APIï¼Œæ‰€æœ‰æ¥å£é€šè¿‡ [app.js](mdc:backend/app.js) ç»Ÿä¸€å¤„ç†ã€‚

### ğŸ”— åŸºç¡€URL
- **å¼€å‘ç¯å¢ƒ**: `http://localhost:3001`
- **ç”Ÿäº§ç¯å¢ƒ**: `http://101.201.148.8:3001`
- **å‰ç«¯ä»£ç†**: `http://localhost:5173` (é€šè¿‡Viteä»£ç†)

## ğŸ” è®¤è¯ç³»ç»Ÿæ¥å£

### ç”¨æˆ·æ³¨å†Œ
```http
POST /api/auth/register
Content-Type: application/json

{
  "username": "testuser",
  "email": "test@example.com",
  "password": "123456",
  "phone": "13800138000"  // å¯é€‰
}
```

### ç”¨æˆ·ç™»å½•
```http
POST /api/auth/login
Content-Type: application/json

{
  "usernameOrEmail": "testuser",
  "password": "123456"
}
```

### è·å–ç”¨æˆ·èµ„æ–™
```http
GET /api/auth/profile
Authorization: Bearer <JWT_TOKEN>
```

### ç”¨æˆ·ç™»å‡º
```http
POST /api/auth/logout
Authorization: Bearer <JWT_TOKEN>
```

## ğŸ’° ç§¯åˆ†ç³»ç»Ÿæ¥å£

### æŸ¥è¯¢ç§¯åˆ†
```http
GET /api/points
Authorization: Bearer <JWT_TOKEN>
```

### ç§¯åˆ†äº¤æ˜“
```http
POST /api/points/transaction
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json

{
  "amount": 100,
  "type": "earned",  // æˆ– "spent"
  "description": "ç­¾åˆ°å¥–åŠ±"
}
```

### ç§¯åˆ†è½¬è´¦
```http
POST /api/points/transfer
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json

{
  "toUserId": "user-id",
  "amount": 50,
  "description": "è½¬è´¦è¯´æ˜"
}
```

### ç§¯åˆ†å†å²
```http
GET /api/points/history?page=1&limit=10
Authorization: Bearer <JWT_TOKEN>
```

## ğŸ“… ç­¾åˆ°ç³»ç»Ÿæ¥å£

### ç­¾åˆ°çŠ¶æ€æŸ¥è¯¢
```http
GET /api/checkin/status
Authorization: Bearer <JWT_TOKEN>
```

### æ‰§è¡Œç­¾åˆ°
```http
POST /api/checkin
Authorization: Bearer <JWT_TOKEN>
```

### ç­¾åˆ°å†å²
```http
GET /api/checkin/history
Authorization: Bearer <JWT_TOKEN>
```

## ğŸ”® å¥‡é—¨éç”²æ¥å£

### æ’ç›˜ç”Ÿæˆ
```http
POST /api/qimen/paipan
Content-Type: application/json

{
  "question": "ä»Šæ—¥è¿åŠ¿å¦‚ä½•ï¼Ÿ"
}
```

### AIåˆ†æï¼ˆæ ‡å‡†ç‰ˆï¼‰
```http
POST /api/analysis/qimen
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json

{
  "question": "ä»Šæ—¥æŠ•èµ„è¿åŠ¿å¦‚ä½•ï¼Ÿ",
  "paipanData": {
    "å®«1": {"å…«é—¨": "å¼€é—¨", "ä¹æ˜Ÿ": "å¤©å¿ƒæ˜Ÿ", ...},
    "å®«2": {"å…«é—¨": "ä¼‘é—¨", "ä¹æ˜Ÿ": "å¤©è“¬æ˜Ÿ", ...}
  }
}
```

### AIåˆ†æï¼ˆç®€å•ç‰ˆï¼‰
```http
POST /api/analysis/qimen/simple
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json
```

### AIåˆ†æï¼ˆæµå¼ç‰ˆï¼‰
```http
POST /api/analysis/qimen/stream
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json
```

## ğŸ¥ ç³»ç»Ÿæ¥å£

### å¥åº·æ£€æŸ¥
```http
GET /health
```

### æœåŠ¡å™¨ä¿¡æ¯
```http
GET /
```

## ğŸ”‘ è®¤è¯è¯´æ˜

### JWT Tokenä½¿ç”¨
1. ç™»å½•æˆåŠŸåè·å¾—token
2. åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ : `Authorization: Bearer <token>`
3. Tokené»˜è®¤æœ‰æ•ˆæœŸ7å¤©
4. å—ä¿æŠ¤çš„æ¥å£éƒ½éœ€è¦æœ‰æ•ˆtoken

### ç§¯åˆ†æ¶ˆè´¹
- AIåˆ†æåŠŸèƒ½éœ€è¦æ¶ˆè´¹ç§¯åˆ†
- æ ‡å‡†åˆ†æ: 100ç§¯åˆ†
- ç®€å•åˆ†æ: 50ç§¯åˆ†
- æµå¼åˆ†æ: 100ç§¯åˆ†

## ğŸ“Š å“åº”æ ¼å¼

### æˆåŠŸå“åº”
```json
{
  "success": true,
  "data": { ... },
  "message": "æ“ä½œæˆåŠŸ"
}
```

### é”™è¯¯å“åº”
```json
{
  "success": false,
  "error": "é”™è¯¯ç±»å‹",
  "message": "è¯¦ç»†é”™è¯¯ä¿¡æ¯"
}
```

## ğŸš¨ é™æµç­–ç•¥

- æ™®é€šç”¨æˆ·: 2æ¬¡/åˆ†é’Ÿ
- é«˜çº§ç”¨æˆ·(5000+ç§¯åˆ†): 5æ¬¡/åˆ†é’Ÿ  
- VIPç”¨æˆ·(10000+ç§¯åˆ†): 10æ¬¡/åˆ†é’Ÿ
- è®¤è¯æ¥å£: 5æ¬¡/15åˆ†é’Ÿ

## ğŸ“ æµ‹è¯•ç”¨ä¾‹

å‚è€ƒ [backend/AUTH_SYSTEM_README.md](mdc:backend/AUTH_SYSTEM_README.md) ä¸­çš„æµ‹è¯•ç¤ºä¾‹ã€‚
