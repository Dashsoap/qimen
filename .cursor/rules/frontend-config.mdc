---
description:
globs:
alwaysApply: false
---
# å¥‡é—¨éç”²AIç³»ç»Ÿ - å‰ç«¯é…ç½®è§„åˆ™

## ğŸ¨ å‰ç«¯æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Vue 3 + Composition API
- **æ„å»ºå·¥å…·**: Vite 5.x
- **UIç»„ä»¶**: Ant Design Vue 4.x
- **çŠ¶æ€ç®¡ç†**: Pinia
- **è·¯ç”±**: Vue Router 4.x
- **HTTPå®¢æˆ·ç«¯**: Axios

## ğŸ“ å‰ç«¯ç›®å½•ç»“æ„

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.vue              # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ main.js              # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ api.js           # APIé…ç½®ä¸­å¿ƒ
â”‚   â”‚   â”œâ”€â”€ mobile-http.js   # ç§»åŠ¨ç«¯HTTPå¤„ç†
â”‚   â”‚   â””â”€â”€ qimenApi.js      # å¥‡é—¨éç”²API
â”‚   â”œâ”€â”€ views/               # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ components/          # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ router/              # è·¯ç”±é…ç½®
â”‚   â””â”€â”€ stores/              # PiniaçŠ¶æ€ç®¡ç†
â”œâ”€â”€ vite.config.js           # Viteé…ç½®
â”œâ”€â”€ capacitor.config.ts      # ç§»åŠ¨ç«¯æ‰“åŒ…é…ç½®
â””â”€â”€ package.json             # ä¾èµ–ç®¡ç†
```

## ğŸŒ APIé…ç½®ä¸­å¿ƒ

### APIåŸºç¡€é…ç½® ([utils/api.js](mdc:frontend/src/utils/api.js))

```javascript
// æ™ºèƒ½ç¯å¢ƒæ£€æµ‹
const getApiBaseUrl = () => {
  // ç§»åŠ¨ç«¯å¼ºåˆ¶ä½¿ç”¨æœåŠ¡å™¨
  if (isMobile) {
    return 'http://101.201.148.8:3001';
  }
  
  // Webç«¯æœ¬åœ°å¼€å‘ä½¿ç”¨ä»£ç†
  if (isLocalDev) {
    return ''; // ç©ºå­—ç¬¦ä¸²ä½¿ç”¨Viteä»£ç†
  }
  
  // å…¶ä»–æƒ…å†µä½¿ç”¨æœåŠ¡å™¨
  return 'http://101.201.148.8:3001';
};
```

### APIç«¯ç‚¹é…ç½®
```javascript
export const API_ENDPOINTS = {
  // è®¤è¯ç³»ç»Ÿ
  AUTH_LOGIN: `${API_BASE_URL}/api/auth/login`,
  AUTH_REGISTER: `${API_BASE_URL}/api/auth/register`,
  AUTH_PROFILE: `${API_BASE_URL}/api/auth/profile`,
  
  // ç§¯åˆ†ç³»ç»Ÿ
  POINTS_GET: `${API_BASE_URL}/api/points`,
  POINTS_TRANSACTION: `${API_BASE_URL}/api/points/transaction`,
  
  // ç­¾åˆ°ç³»ç»Ÿ
  CHECKIN_STATUS: `${API_BASE_URL}/api/checkin/status`,
  CHECKIN_DO: `${API_BASE_URL}/api/checkin`,
  
  // å¥‡é—¨éç”²
  QIMEN_PAIPAN: `${API_BASE_URL}/api/qimen/paipan`,
  QIMEN_ANALYSIS: `${API_BASE_URL}/api/analysis/qimen`,
  QIMEN_ANALYSIS_STREAM: `${API_BASE_URL}/api/analysis/qimen/stream`,
  
  // å¥åº·æ£€æŸ¥
  HEALTH_CHECK: `${API_BASE_URL}/health`
};
```

## ğŸ”§ Viteé…ç½® ([vite.config.js](mdc:frontend/vite.config.js))

### å¼€å‘ä»£ç†é…ç½®
```javascript
export default defineConfig({
  server: {
    host: '0.0.0.0',
    port: 5173,
    proxy: {
      '/api': {
        target: 'http://localhost:3001',
        changeOrigin: true,
        secure: false
      },
      '/health': {
        target: 'http://localhost:3001',
        changeOrigin: true,
        secure: false
      }
    }
  }
})
```

### ä»£ç†å·¥ä½œåŸç†
- **å‰ç«¯è¯·æ±‚**: `http://localhost:5173/api/auth/login`
- **ä»£ç†è½¬å‘**: `http://localhost:3001/api/auth/login`
- **é¿å…CORS**: å¼€å‘ç¯å¢ƒæ— è·¨åŸŸé—®é¢˜

## ğŸ“± ç§»åŠ¨ç«¯é…ç½®

### Capacitoré…ç½® ([capacitor.config.ts](mdc:frontend/capacitor.config.ts))
```typescript
const config: CapacitorConfig = {
  appId: 'com.guigu.qimen',
  appName: 'é¬¼è°·å¥‡é—¨',
  webDir: 'dist',
  server: {
    androidScheme: 'https'
  }
};
```

### ç§»åŠ¨ç«¯APIå¤„ç†
- **è‡ªåŠ¨æ£€æµ‹**: ç§»åŠ¨ç«¯ç¯å¢ƒè‡ªåŠ¨ä½¿ç”¨æœåŠ¡å™¨åœ°å€
- **ç½‘ç»œä¼˜åŒ–**: ä¸“é—¨çš„ç§»åŠ¨ç«¯HTTPå¤„ç† ([mobile-http.js](mdc:frontend/src/utils/mobile-http.js))
- **é”™è¯¯é‡è¯•**: æ™ºèƒ½é‡è¯•æœºåˆ¶å’Œå¤‡ç”¨æœåŠ¡å™¨

## ğŸš€ å¼€å‘å¯åŠ¨

### æœ¬åœ°å¼€å‘
```bash
cd frontend
npm install
npm run dev
```

### ç§»åŠ¨ç«¯å¼€å‘
```bash
# Android
npm run android

# iOS  
npm run ios
```

### ç”Ÿäº§æ„å»º
```bash
npm run build
```

## ğŸ¯ é¡µé¢è·¯ç”±

### ä¸»è¦é¡µé¢
- `/home` - é¦–é¡µ
- `/qimen` - å¥‡é—¨éç”²åˆ†æ
- `/profile` - ç”¨æˆ·ä¸­å¿ƒ
- `/about` - å…³äºé¡µé¢

### è·¯ç”±é…ç½®
å‚è€ƒ [router/](mdc:frontend/src/router) ç›®å½•ä¸‹çš„è·¯ç”±é…ç½®æ–‡ä»¶ã€‚

## ğŸ” è®¤è¯çŠ¶æ€ç®¡ç†

### Tokenç®¡ç†
- ç™»å½•æˆåŠŸåè‡ªåŠ¨å­˜å‚¨token
- è¯·æ±‚æ‹¦æˆªå™¨è‡ªåŠ¨æ·»åŠ Authorizationå¤´
- Tokenè¿‡æœŸè‡ªåŠ¨è·³è½¬ç™»å½•é¡µ

### ç”¨æˆ·çŠ¶æ€
ä½¿ç”¨Piniaç®¡ç†ç”¨æˆ·ç™»å½•çŠ¶æ€å’Œç§¯åˆ†ä¿¡æ¯ã€‚

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥
- APIå“åº”ç¼“å­˜
- å›¾ç‰‡èµ„æºæ‡’åŠ è½½
- ç»„ä»¶æŒ‰éœ€åŠ è½½

### ç§»åŠ¨ç«¯ä¼˜åŒ–
- ä¸“é—¨çš„ç§»åŠ¨ç«¯æ€§èƒ½ç®¡ç†å™¨
- å†…å­˜ç®¡ç†å’Œé¡µé¢å¯è§æ€§æ£€æµ‹
- ç½‘ç»œçŠ¶æ€æ£€æµ‹å’Œç¦»çº¿å¤„ç†

## ğŸ› ï¸ å¼€å‘å·¥å…·

### è°ƒè¯•å·¥å…·
- Vue DevTools
- PageSpy (ç”Ÿäº§ç¯å¢ƒç›‘æ§)
- Viteå¼€å‘æœåŠ¡å™¨çƒ­é‡è½½

### ä»£ç è§„èŒƒ
- ESLinté…ç½®
- Vue 3 Composition APIæœ€ä½³å®è·µ
- TypeScriptæ”¯æŒ

## ğŸ“ å¸¸è§é—®é¢˜

### APIè°ƒç”¨å¤±è´¥
1. æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨ (`node backend/app.js`)
2. ç¡®è®¤ä»£ç†é…ç½®æ­£ç¡®
3. æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé˜²ç«å¢™è®¾ç½®

### ç§»åŠ¨ç«¯é—®é¢˜
1. ç¡®ä¿æœåŠ¡å™¨åœ°å€å¯è®¿é—®
2. æ£€æŸ¥ç§»åŠ¨è®¾å¤‡ç½‘ç»œè®¾ç½®
3. æŸ¥çœ‹ç§»åŠ¨ç«¯è°ƒè¯•æ—¥å¿—
